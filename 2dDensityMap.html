<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="style.css" />
        <script src="http://d3js.org/d3.v4.js"></script>
        <script src="https://d3js.org/d3-contour.v1.min.js"></script>
        <title>Data visualisation du groupe Deep Bridge 1</title>
    </head>

    <header>
    	<div id="titre_principal">
            <h1>Data visualisation du groupe Deep Bridge 1</h1>
        </div>
	</header>

	<nav>
		<ul>
			<li><a href="accueil.html">ACCUEIL</a></li>
	    	<li><a href="histogrammes.html">HISTOGRAMMES</a></li>
	    	<li><a href="parallelCoordinates.html">PARALLEL COORDINATES</a></li>
	    	<li><a href="scatterPlot.html">SCATTER PLOT</a></li>
	    	<li><a href="2dDensityMap.html">2D DENSITY MAP</a></li>
	    	<li><a href="parallelSet.html">PARALLEL SETS</a></li>
	    </ul>
	</nav>

    <body>
    	<section>
	    	<p>On cherche une corrélation entre le prix d’une voiture et le taux d’endettement d’un client. On veut en effet observer si le revenu d’un client influe sur le prix du véhicule qu’il achète. Pour cela, on réalise une 2D Density Map, sous forme de 	Contour Map, du taux d’endettement d’un client en fonction du prix de la voiture qu’il possède.</p>

			<p>Une 2D Density Map permet de visualiser la distribution jointe de deux variables quantitatives. Le nombre d’observations dans une zone précise du plan est compté et ensuite représenté par des contours. Plus il y a de contours, plus la zone est dense, et donc plus il y a d’observations dans cette région.</p>

			<p>En passant la souris sur une ligne, une pop-up affiche la densité de la zone.</p>
	    	<div id="my_dataviz"></div>
			<script>
				// set the dimensions and margins of the graph
				var margin = {top: 20, right: 30, bottom: 30, left: 50},
				    width = 960 - margin.left - margin.right,
				    height = 500 - margin.top - margin.bottom;

				// append the svg object to the body of the page
				var svg = d3.select("#my_dataviz")
				  .append("svg")
				    .attr("width", width + margin.left + margin.right)
				    .attr("height", height + margin.top + margin.bottom)
				  .append("g")
				    .attr("transform",
				          "translate(" + margin.left + "," + margin.top + ")");

				// read data
				d3.csv("https://raw.githubusercontent.com/AlexandreTrujillo/DataVizTPTDeepBridge1/master/small_data_cleaned.csv", function(data) {


				  var tooltip = d3.select("#my_dataviz")
				    .append("div")
				    .style("opacity", 0)
				    .attr("class", "tooltip")

				  // Three function that change the tooltip when user hover / move / leave a cell

				   var mouseover = function(d) {
				    tooltip.style("opacity", 1)
				  }
				  
				  var mousemove = function(d) {
				    tooltip
				      .html("Densité: " + d.value)
				      .style("left", (d3.event.pageX + 15) + "px")
					  .style("top", (d3.event.pageY - 28) + "px")
					  .transition()
					  .duration(200) 
					  .style("opacity", .9)
				  }
				  
				  var mouseleave = function(d) {
				    tooltip
					      .transition()
					      .duration(200)
					      .style("opacity", 0)
				  }

				  // Add X axis
				  var x = d3.scaleLinear()
				    .domain(d3.extent(data, function(d) { return +d["taux"]; }))
				    .range([ 0, width ]);
				  svg.append("g")
				    .attr("transform", "translate(0," + height + ")")
				    .call(d3.axisBottom(x));

				  // Add Y axis
				  var y = d3.scaleLinear()
				    .domain(d3.extent(data, function(d) { return +d["prix"]; }))
				    .range([ height, 0 ]);
				  svg.append("g")
				    .call(d3.axisLeft(y));


				  
				  // compute the density data
				  var densityData = d3.contourDensity()
				    .x(function(d) { return x(d.taux); })   // x and y = column name in .csv input data
				    .y(function(d) { return y(d.prix); })
				    .size([width, height])
				    .bandwidth(15)    // smaller = more precision in lines = more lines
				    (data)

				  // Add the contour: several "path"
				  svg
				    .selectAll("path")
				    .data(densityData)
				    .enter()
				    .append("path")
				      .attr("d", d3.geoPath())
				      .attr("fill", "none")
				      .attr("stroke", "#440154FF")
				      .attr("stroke-linejoin", "round")
				      .on("mouseover", mouseover)
				      .on("mousemove", mousemove)
				      .on("mouseleave", mouseleave)
				})
				</script>
	    </section>
	</body>
</html>